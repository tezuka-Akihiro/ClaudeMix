# Phase 5.2: CSSå®Ÿè£…ï¼ˆğŸ¨ï¼‰

ã‚ãªãŸã¯ã€TDDé–‹ç™ºãƒ•ãƒ­ãƒ¼ã®CSSå®Ÿè£…ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

## ğŸ¯ ç›®çš„

**5éšå±¤ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°æ†²ç« **ã«å¾“ã„ã€Layer 2ï¼ˆComponent Stylesï¼‰ã€Layer 3ï¼ˆFlexbox/Gridï¼‰ã€Layer 4ï¼ˆStructure Exceptionsï¼‰ã‚’é †ç•ªã«å®Ÿè£…ã™ã‚‹ã€‚

## ğŸ“‹ æˆæœç‰©

1. **Layer 2: Component Styles** - `app/styles/{service}/layer2-{section}.css`
2. **Layer 3: Flexbox and Grid Layout** - `app/styles/{service}/layer3.ts`
3. **Layer 4: Structure Exceptions** - `app/styles/{service}/layer4.ts`

## ğŸ“ å‰ææ¡ä»¶

- Phase 5.1ãŒå®Œäº†ã—ã¦ã„ã‚‹ï¼ˆE2Eãƒ†ã‚¹ãƒˆãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ï¼‰
- uiux-spec.mdã«ç”»é¢ä»•æ§˜ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- `docs/CSS_structure/STYLING_CHARTER.md`ã‚’ç†è§£ã—ã¦ã„ã‚‹

## æ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ï¼ˆCoTï¼‰

ä»¥ä¸‹ã®é †åºã§æ®µéšçš„ã«å®Ÿè£…ã—ã¦ãã ã•ã„ï¼š

```text
Step 1: uiux-spec.mdã‚’èª­ã¿è¾¼ã¿ã€UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆã‚’ç†è§£ã™ã‚‹
  â†’ ã©ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã‚¹ã‚¿ã‚¤ãƒ«ãŒå¿…è¦ã‹ï¼Ÿ

Step 2: Layer 1ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç¢ºèªã™ã‚‹
  â†’ app/styles/globals.css ã§å®šç¾©ã•ã‚ŒãŸ Application Tokens

Step 3: Layer 2ï¼ˆComponent Stylesï¼‰ã‚’å®Ÿè£…ã™ã‚‹
  â†’ è‰²ã€ã‚µã‚¤ã‚ºã€ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£ç­‰ã‚’ Layer 1 ãƒˆãƒ¼ã‚¯ãƒ³ã‹ã‚‰å‚ç…§

Step 4: Layer 3ï¼ˆFlexbox/Gridï¼‰ã‚’å®Ÿè£…ã™ã‚‹
  â†’ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ­ã‚¸ãƒƒã‚¯ï¼ˆflex, grid, gapï¼‰ã®ã¿è¿½åŠ 

Step 5: Layer 4ï¼ˆStructure Exceptionsï¼‰ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆå¿…è¦ãªå ´åˆã®ã¿ï¼‰
  â†’ ç–‘ä¼¼è¦ç´ ã€å­å­«ã‚»ãƒ¬ã‚¯ã‚¿ã€ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

Step 6: CSSè¦å¾‹æ¤œè¨¼ã‚’å®Ÿè¡Œã™ã‚‹
  â†’ scripts/run-css-lint.sh ã§é•åã‚’æ¤œå‡º
```

## âš™ï¸ å®Ÿè¡Œæ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ— 1: Layer 2 - Component Styles

**ç›®çš„**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå˜ä½ã§CSSã‚»ãƒ¬ã‚¯ã‚¿ã‚’å®šç¾©ã—ã€è¦‹ãŸç›®ã¨ã‚µã‚¤ã‚ºã‚’å®šç¾©ã™ã‚‹ã€‚

**å‡ºåŠ›**: `app/styles/{service}/layer2-{section}.css`

**å®Ÿè£…å†…å®¹**:
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©ï¼ˆè‰²ã€ã‚µã‚¤ã‚ºã€ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£ç­‰ï¼‰
- Layer 1ã®Application Tokensã‚’`var()`ã§å‚ç…§
- çŠ¶æ…‹åˆ¥ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆ`:hover`, `.completed`ç­‰ï¼‰

**å‘½åè¦å‰‡**:
- ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ: `.{component}-{variant?}` ã¾ãŸã¯ `.{category}-{component}-{variant?}`
- ä¾‹: `.checkpoint`, `.button-primary`, `.page-header`

**å®Ÿè£…ä¾‹**:

```css
/* app/styles/{service}/layer2-{section}.css */

.checkpoint {
  background-color: var(--color-background-secondary);
  color: var(--color-text-primary);
  border: 1px solid var(--color-accent-gold);
  border-radius: var(--border-radius-md);
  padding: var(--spacing-3);
  font-size: var(--font-size-base);
  transition: background-color 0.3s ease;
}

.checkpoint:hover {
  background-color: var(--color-background-primary);
}

.checkpoint.completed {
  background-color: var(--color-status-success);
  border-color: var(--color-status-success);
}
```

**åˆ¶ç´„**:
- âŒ **ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã®ç¦æ­¢**: è‰²ã‚„ã‚µã‚¤ã‚ºã‚’ç›´æ¥æŒ‡å®šã›ãšã€å¿…ãš`var(--*)`ã§å‚ç…§
- âŒ **ãƒ•ãƒ¬ãƒƒã‚¯ã‚¹ãƒ»ã‚°ãƒªãƒƒãƒ‰ã®ç¦æ­¢**: `flex`, `grid`, `gap`ã¯å®šç¾©ã—ãªã„ï¼ˆLayer 3ã®è²¬å‹™ï¼‰
- âŒ **CSSå¤‰æ•°ã®æ–°è¦å®šç¾©ç¦æ­¢**: Layer 2ã§ã¯æ–°ã—ã„CSSå¤‰æ•°ã‚’å®šç¾©ã—ãªã„ï¼ˆLayer 1ã§å®šç¾©æ¸ˆã¿ã®ã‚‚ã®ã‚’ä½¿ç”¨ï¼‰

**å‚ç…§**: `docs/CSS_structure/STYLING_CHARTER.md`

### ã‚¹ãƒ†ãƒƒãƒ— 2: Layer 3 - Flexbox and Grid Layout

**ç›®çš„**: Layer 2ã§å®šç¾©ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚»ãƒ¬ã‚¯ã‚¿ã«ã€ãƒ•ãƒ¬ãƒƒã‚¯ã‚¹ãƒ»ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’è¿½åŠ ã™ã‚‹ã€‚

**å‡ºåŠ›**: `app/styles/{service}/layer3.ts`

**å®Ÿè£…å†…å®¹**:
- `addComponents`ã‚’ä½¿ã£ã¦Tailwind pluginã¨ã—ã¦ç™»éŒ²
- Layer 2ã¨åŒã˜ã‚»ãƒ¬ã‚¯ã‚¿åã‚’ä½¿ç”¨
- `gap`, `display: flex`, `align-items`ç­‰ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ã¿å®šç¾©

**å®Ÿè£…ä¾‹**:

```typescript
// app/styles/{service}/layer3.ts
import plugin from 'tailwindcss/plugin'

export default plugin(({ addComponents }) => {
  addComponents({
    '.checkpoint-list': {
      display: 'flex',
      flexDirection: 'column',
      gap: 'var(--spacing-4)',
      alignItems: 'flex-start',
    },
    '.checkpoint-grid': {
      display: 'grid',
      gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
      gap: 'var(--spacing-3)',
    },
  })
})
```

**åˆ¶ç´„**:
- âœ… **gapä¾‹å¤–**: `gap/row-gap/column-gap`ã®ã¿ã€Layer 1ã®`var(--spacing-*)`ã‚’ç›´æ¥å‚ç…§å¯èƒ½
- âŒ **è‰²ãƒ»ã‚µã‚¤ã‚ºã®ç¦æ­¢**: `color`, `width`, `padding`ç­‰ã¯å®šç¾©ã—ãªã„ï¼ˆLayer 2ã®è²¬å‹™ï¼‰

**å‚ç…§**: `docs/CSS_structure/STYLING_CHARTER.md`

### ã‚¹ãƒ†ãƒƒãƒ— 3: Layer 4 - Structure Exceptionsï¼ˆå¿…è¦ãªå ´åˆã®ã¿ï¼‰

**ç›®çš„**: Layer 3ã§ã‚«ãƒãƒ¼ã§ããªã„ä¾‹å¤–çš„ãªæ§‹é€ ã‚’å®šç¾©ã™ã‚‹ã€‚

**å‡ºåŠ›**: `app/styles/{service}/layer4.ts`

**å®Ÿè£…å†…å®¹**:
- ç–‘ä¼¼è¦ç´ ï¼ˆ`::before`, `::after`ï¼‰
- å­å­«ã‚»ãƒ¬ã‚¯ã‚¿ï¼ˆ`.parent .child`ï¼‰
- ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ`@keyframes`ï¼‰

**å®Ÿè£…ä¾‹**:

```typescript
// app/styles/{service}/layer4.ts
import plugin from 'tailwindcss/plugin'

export default plugin(({ addComponents }) => {
  addComponents({
    '.checkpoint::before': {
      content: '""',
      display: 'block',
      width: '4px',
      height: '100%',
      backgroundColor: 'var(--color-accent-gold)',
      position: 'absolute',
      left: '0',
      top: '0',
    },
    '@keyframes fadeIn': {
      from: { opacity: '0' },
      to: { opacity: '1' },
    },
    '.checkpoint.animate': {
      animation: 'fadeIn 0.3s ease-in',
    },
  })
})
```

**å‚ç…§**: `docs/CSS_structure/STYLING_CHARTER.md`

### ã‚¹ãƒ†ãƒƒãƒ— 4: CSSè¦å¾‹æ¤œè¨¼

CSSå®Ÿè£…å®Œäº†å¾Œã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦CSSè¦å¾‹æ¤œè¨¼ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
# CSSè¦å¾‹æ¤œè¨¼ã‚’å®Ÿè¡Œ
./scripts/run-css-lint.sh
```

é•åãŒæ¤œå‡ºã•ã‚ŒãŸå ´åˆã€`tests/lint/css-arch-layer-report.md`ã‚’ç¢ºèªã—ã¦ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚

## âœ… å®Œäº†æ¡ä»¶

- [ ] Layer 2ï¼ˆComponent Stylesï¼‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] Layer 3ï¼ˆFlexbox/Gridï¼‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] Layer 4ï¼ˆStructure Exceptionsï¼‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼ˆå¿…è¦ãªå ´åˆã®ã¿ï¼‰
- [ ] CSSè¦å¾‹æ¤œè¨¼ãŒåˆæ ¼ã—ã¦ã„ã‚‹
- [ ] uiux-spec.mdã®UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã™ã¹ã¦ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸè‰²ãƒ»ã‚µã‚¤ã‚ºï¼‰ãŒå­˜åœ¨ã—ãªã„

## ğŸ”— æ¬¡ãƒ•ã‚§ãƒ¼ã‚º

**Phase 5.3: TDDå®Ÿè£…ãƒ«ãƒ¼ãƒ—** (`prompts/05-03-tdd-loop.md`)

## ğŸ“š å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `docs/CSS_structure/STYLING_CHARTER.md`: ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°æ†²ç« ï¼ˆ5éšå±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼‰
- `app/styles/globals.css`: Layer 1 Application Tokens
- `develop/{service}/{section}/uiux-spec.md`: ç”»é¢ä»•æ§˜æ›¸
- `scripts/run-css-lint.sh`: CSSè¦å¾‹æ¤œè¨¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- `tests/lint/css-arch-layer-report.md`: CSSè¦å¾‹æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ
