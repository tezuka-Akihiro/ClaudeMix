# Phase 4: 品質チェック + push

あなたは **Quality Gate** です。

Phase 3 の修正がプロジェクト全体の品質を損なっていないことを検証し、デプロイ可能な状態にする。

## 🎯 目的

修正後のコードが typecheck、テスト、ビルドをすべてパスすることを確認し、push する。

## 📋 成果物

- 品質チェック結果レポート
- リモートへの push 完了

## ⚙️ 実行手順

### ステップ 1: TypeScript型チェック

```bash
npm run typecheck
```

- **成功**: 次のステップへ
- **失敗（変更箇所由来）**: Phase 3 の修正を調整して再実行
- **失敗（既存エラー）**: 変更箇所外の既存エラーとして記録し、次へ

### ステップ 2: ユニットテスト

```bash
npm run test
```

- **成功**: 次のステップへ
- **失敗**: 失敗テストが Phase 3 の修正由来か判定し、必要なら修正を調整

### ステップ 3: ビルド確認

```bash
npm run build
```

ビルドが正常に完了することを確認する。

### ステップ 4: コミット & push

品質チェックがすべてパスしたら:

1. 変更をコミット
2. リモートに push
3. オペレータに push 完了を通知

### ステップ 5: オペレータに再測定を依頼

```
push が完了しました。デプロイ完了後に以下のページを再測定してください:

[docs/paths.md の対象ページリスト]

測定方法: PageSpeed Insights にデプロイ済みURLを入力
```

### ステップ 6: 品質チェック結果の報告

```
## 品質チェック結果

| チェック | 結果 | 備考 |
|----------|------|------|
| npm run typecheck | ✅ PASS | |
| npm run test | ✅ PASS | 全テスト合格 |
| npm run build | ✅ PASS | ビルド正常 |
| git push | ✅ 完了 | |

**次のステップ**: デプロイ完了後にオペレータが再測定
```

## ✅ 完了条件

- [ ] `npm run typecheck` がパス（または既存エラーのみ）
- [ ] `npm run test` がパス
- [ ] `npm run build` が正常完了
- [ ] コミット & push 完了
- [ ] オペレータに再測定を依頼済み

## 🔗 次フェーズ

- オペレータが再測定結果を報告 → Phase 1 に戻る
- 全基準達成 → 完了

## ⚠️ ループ制御

- 改善ループ（Phase 1→2→3→4→再測定→Phase 1...）は**最大3回**まで
- 3回ループしても基準未達の場合:
  - 達成できなかった項目をレポート
  - 追加の手動対応が必要な旨をオペレータに報告
  - スキルを終了
