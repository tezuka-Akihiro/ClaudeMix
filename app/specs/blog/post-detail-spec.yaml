# spec.yaml - 外部変数仕様書
# 実装・テスト・仕様書で共通参照するリテラル値定義

# ==========================================
# メタデータ
# ==========================================
metadata:
  feature_name: "記事詳細表示"
  slug: "post-detail"
  created_date: "2025-11-14"
  last_updated: "2025-11-14"
  version: "1.0.0"

# ==========================================
# サーバー処理設定 (Loader/Action)
# ==========================================
server_io:
  loader:
    # loader処理のタイムアウト設定 (ms)
    timeout: 5000
  # このセクションではactionは存在しない（閲覧のみ）
  action: null

# ==========================================
# メッセージ定数
# ==========================================
messages:
  error:
    not_found: "記事が見つかりませんでした"
    network: "記事の読み込みに失敗しました"
    server: "サーバーエラーが発生しました"
    markdown_conversion: "記事の変換処理でエラーが発生しました"

# ==========================================
# UI要素セレクタ（テスト用）
# ==========================================
ui_selectors:
  article:
    container: "[data-testid='post-detail-section']"
    title: "[data-testid='article-title']"
    published_date: "[data-testid='article-published-date']"
    author: "[data-testid='article-author']"
    content: "[data-testid='article-content']"

  table_of_contents:
    container: "[data-testid='table-of-contents']"
    item: "[data-testid='toc-item']"
    link: "[data-testid='toc-link']"

  loading:
    spinner: "[data-testid='loading-spinner']"

  error:
    message: "[data-testid='error-message']"

# ==========================================
# マークダウン処理設定
# ==========================================
markdown:
  supported_features:
    - "見出し (h1-h6)"
    - "段落 (p)"
    - "リスト (ul, ol)"
    - "コードブロック (pre, code)"
    - "引用 (blockquote)"
    - "リンク (a)"
    - "画像 (img)"
    - "Mermaid図"
    - "シンタックスハイライト"

  security:
    # XSS対策のためサニタイズを実施
    sanitize_html: true
    allowed_tags:
      - "h1"
      - "h2"
      - "h3"
      - "h4"
      - "h5"
      - "h6"
      - "p"
      - "ul"
      - "ol"
      - "li"
      - "pre"
      - "code"
      - "blockquote"
      - "a"
      - "img"
      - "div"
      - "span"
      - "strong"
      - "em"

# ==========================================
# アクセス制御設定
# ==========================================
access_control:
  # 見出しベースペイウォール設定
  free_content_heading:
    # frontmatterフィールド名
    field_name: "freeContentHeading"
    # 型: string | null
    type: "string"
    # 説明
    description: "この見出しの終わりまでを無料公開範囲とする"
    # デフォルト値（未指定時は全文公開）
    default: null
