# spec.yaml - 外部変数仕様書
# 実装・テスト・仕様書で共通参照するリテラル値定義

# ==========================================
# メタデータ
# ==========================================
metadata:
  feature_name: "記事詳細表示"
  slug: "post-detail"
  created_date: "2025-11-14"
  last_updated: "2025-11-14"
  version: "1.0.0"

# ==========================================
# サーバー処理設定 (Loader/Action)
# ==========================================
server_io:
  loader: {}
  # このセクションではactionは存在しない（閲覧のみ）
  action: null

# ==========================================
# 購読促進設定
# ==========================================
promotion:
  title: "すべての記事を読むには会員登録が必要です"
  button_label: "プランを見る"
  plans:
    - duration: "1ヶ月"
      price: "¥980/月"
    - duration: "3ヶ月"
      price: "¥2,700 (¥900/月)"
      badge: "8%お得"
    - duration: "6ヶ月"
      price: "¥4,900 (¥817/月)"

# ==========================================
# メッセージ定数
# ==========================================
messages:
  ui:
    author_label: "著者:"
    paywall_message: "続きを読むには会員登録が必要です"
  error:
    not_found: "記事が見つかりませんでした"
    network: "通信エラーが発生しました"
    server: "サーバーエラーが発生しました"
    markdown_conversion: "マークダウンの変換に失敗しました"
    referenced_file_not_found: "参照されている記事ファイルが見つかりません"
  paywall:
    message: "この記事の続きは、サブスクリプション会員限定です。"
    promotion_heading: "プレミアムプランで続きを読む"
    cta_label: "プランを選択する"

# ==========================================
# UI要素セレクタ（テスト用）
# ==========================================
ui_selectors:
  article:
    container: "[data-testid='post-detail-section']"
    title: "[data-testid='article-title']"
    published_date: "[data-testid='article-published-date']"
    author: "[data-testid='article-author']"
    content: "[data-testid='article-content']"
    thumbnail_container: "[data-testid='article-thumbnail-container']"
    thumbnail_image: "[data-testid='article-thumbnail-image']"

  table_of_contents:
    container: "[data-testid='table-of-contents']"
    item: "[data-testid='toc-item']"
    link: "[data-testid='toc-link']"

  loading:
    spinner: "[data-testid='loading-spinner']"

  error:
    message: "[data-testid='error-message']"

# ==========================================
# サムネイル画像表示設定
# ==========================================
thumbnail:
  # 表示設定
  display:
    # サムネイル表示を有効化
    enabled: true
    # サムネイルが存在しない場合の動作
    fallback: "hide"  # "hide" | "placeholder"
    # 表示位置
    position: "header"  # 記事ヘッダー部分に表示

  # CLS対策（レイアウトシフト防止）
  performance:
    # CSS aspect-ratio
    aspect_ratio: "1200 / 630"
    # 遅延読み込み
    loading: "lazy"
    # 非同期デコード
    decoding: "async"

  # スタイル設定
  styles:
    # 画像コンテナのCSSクラス
    container_class: "article-thumbnail-container"
    # 画像のobject-fit
    object_fit: "cover"
    # 角丸
    border_radius: "8px"
    # 最大幅
    max_width: "100%"

# ==========================================
# マークダウン処理設定
# ==========================================
markdown:
  supported_features:
    - "見出し (h1-h6)"
    - "段落 (p)"
    - "リスト (ul, ol)"
    - "コードブロック (pre, code)"
    - "引用 (blockquote)"
    - "リンク (a)"
    - "画像 (img)"
    - "Mermaid図"
    - "シンタックスハイライト"

  security:
    # XSS対策のためサニタイズを実施
    sanitize_html: true
    allowed_tags:
      - "h1"
      - "h2"
      - "h3"
      - "h4"
      - "h5"
      - "h6"
      - "p"
      - "ul"
      - "ol"
      - "li"
      - "pre"
      - "code"
      - "blockquote"
      - "a"
      - "img"
      - "div"
      - "span"
      - "strong"
      - "em"

# ==========================================
# アクセス制御設定
# ==========================================
access_control:
  # 見出しベースペイウォール設定
  free_content_heading:
    # frontmatterフィールド名
    field_name: "freeContentHeading"
    # 型: string | null
    type: "string"
    # 説明
    description: "この見出しの終わりまでを無料公開範囲とする"
    # デフォルト値（未指定時は全文公開）
    default: null

# ==========================================
# アクセシビリティ (ARIA)
# ==========================================
accessibility:
  aria_labels:
    toc: "目次"
