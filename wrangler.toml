name = "claudemix"
compatibility_flags = ["nodejs_compat"]
compatibility_date = "2024-11-18"

# Pages Functions configuration
pages_build_output_dir = "./build/client"

# ============================================
# ローカル開発サーバー設定
# ============================================
# npm run dev:wrangler のポートはここで一元管理
[dev]
port = 3000

# ============================================
# 環境変数（非秘匿情報）
# ============================================
# 秘匿情報は .dev.vars または Cloudflare ダッシュボードで管理
# 参照: .dev.vars.example
[vars]
# ローカル開発用のアプリケーションURL
APP_URL = "http://localhost:3000"
# Google OAuth（クライアントIDは公開情報）
GOOGLE_CLIENT_ID = "395752864569-ng3tot15p3ufguvcuchre6jnfvta5d3p.apps.googleusercontent.com"
GOOGLE_REDIRECT_URI = "http://localhost:3000/auth/callback/google"
# Stripe 公開キー（pk_ は公開用）
STRIPE_PUBLISHABLE_KEY = "pk_test_51StRLVFTLZPZU8HQHblw6Ig1B6V19aU4qzs8TuvrPLfdqnujKX7eG3ynOqRK7PGCBxFU195Ikgzqp29ljaBXHUS000suqIsrSI"

# ============================================
# Local development configuration
# ============================================
# These bindings are used when running "npm run dev:wrangler"
[[d1_databases]]
binding = "DB"
database_name = "claudemix-dev"
database_id = "local-dev-db"

[[kv_namespaces]]
binding = "SESSION_KV"
id = "local-dev-kv"

# Production environment configuration
[env.production.vars]
# 本番環境用のアプリケーションURL
APP_URL = "https://claudemix.dev"
# Google OAuth（クライアントIDは公開情報）
GOOGLE_CLIENT_ID = "395752864569-2ts1a1k73qbuisuup3u8umui7e6gonct.apps.googleusercontent.com"
# Google OAuth リダイレクトURI（本番環境用）
GOOGLE_REDIRECT_URI = "https://claudemix.dev/auth/callback/google"
# Stripe 公開キー（本番用）
STRIPE_PUBLISHABLE_KEY = "pk_live_51StRLCF7UhZtoqG9pDlguHMJkY6DOjvNxfJsJBnvJdcIquvKFz67Km6XjRL2AKgrdz6oROUP0r25IsvWW7dP8tUU00OtUGi6HW"

[[env.production.d1_databases]]
binding = "DB"
database_name = "claudemix-prod"
database_id = "f9a19560-ec16-4eb5-9d7c-a76dd1887640"

[[env.production.kv_namespaces]]
binding = "SESSION_KV"
id = "228032d075f6418e9c8a770c3cf1180b"

# Preview environment configuration (for all non-main branches)
# SETUP REQUIRED: Create preview database and KV namespace
# See docs/setup/preview-environment.md for instructions
[env.preview.vars]
# プレビュー環境用のアプリケーションURL
APP_URL = "https://claudemix.stg.your-domain.pages.dev"
# Google OAuth リダイレクトURI（プレビュー環境用）
GOOGLE_REDIRECT_URI = "https://claudemix.stg.dev/auth/callback/google"

[[env.preview.d1_databases]]
binding = "DB"
database_name = "claudemix-preview"
database_id = "30acb93e-d2a4-4d68-a85c-4479763a5144"

[[env.preview.kv_namespaces]]
binding = "SESSION_KV"
id = "cf119c087e3a424e8731ae0b4ee78368"
