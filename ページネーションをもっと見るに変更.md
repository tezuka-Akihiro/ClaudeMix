# 【機能修正提案】ページネーションを「もっと見る」ボタンに変更

- **サービス**: `blog`
- **セクション**: `posts`
- **関連ドキュメント**:
  - `(関連する機能設計書や設計書、TDD作業手順書などのパスを記載)`

---

## 1. 提案概要

ブログ記事一覧のページネーションを廃止し、Google Blog形式の「もっと見る」ボタンによる追加読み込みUIに変更します。

## 2. 変更内容 (As-Is / To-Be)

### 現状 (As-Is)

- 記事一覧の下部にページネーションが表示されている。
- ユーザーはページ番号等を操作して画面遷移を行う必要がある。

### 修正後 (To-Be)

- 記事一覧の最下部に英語ラベル（例: "More" / "Load More"）のボタンを配置する。
- ボタンを押下すると、ロード中はラベルが「くるくる（スピナー）」等のローディング表示になる。
- 記事を**6件**ロードし、記事一覧の最下部に追加表示する。
- 追加後、ボタンはリストの最下部に移動する。

## 3. 背景・目的

### 背景

現在のページネーション形式は冗長であり、スムーズな閲覧体験を阻害しているため。

### 目的

- **目的1**: ページ遷移をなくし、シームレスな閲覧体験を提供する。
- **目的2**: Google Blog形式のモダンな挙動に合わせる。
- **目的3**: UIの冗長性を排除する。

## 4. 変更の妥当性 (Pros / Cons)

`@ArchitectureGuardian` の視点に基づき、この変更がプロジェクトの設計思想に合致するかを評価します。

Pros (利点):

- ユーザーのアクション数が減り、コンテンツ閲覧の継続性が向上する。
- モバイルデバイス等での操作性が向上する。

Cons (懸念点):

- 記事数が増えた際、フッターへのアクセスが困難になる可能性がある。
- 特定のページ位置へのリンク共有が難しくなる。

**総合評価**:
ブログというサービスの特性上、最新記事からのストリーム閲覧が主となるため、ページネーションよりもUX上のメリットが大きいと判断します。

## 5 設計フロー

以下の設計ドキュメントを上から順に確認し、編集内容を追記して。

### 🗾GUIDING_PRINCIPLES.md

### 📚️func-spec.md

### 🖼️uiux-spec.md

### 📋️spec.yaml

### 🗂️file_list.md

### 🧬data-flow-diagram.md

## 6 TDD_WORK_FLOW.md 簡易版

以下の全項目に対して、実際のパスと編集内容を1行で記載して。
完全な計画ではなく、大枠がわかればよい。
特に、新規ファイルに関して把握したい。

### 👁️e2e-screen-test

- **実施は最後**：ユーザーが手動で実施

### 👁️e2e-section-test

- `tests/e2e/section/blog/posts.spec.ts` - ページネーションテストを削除し、LoadMoreButtonのクリックと追加読み込みテストを追加

### 🎨CSS実装 (layer2.css, layer3.ts, layer4.ts)

- `app/styles/blog/layer2-posts.css` - Paginationスタイルを削除、LoadMoreButtonスタイルを追加（ボタン、スピナー、ローディング状態）
- `app/styles/blog/layer3-posts.ts` - Paginationスタイルを削除、LoadMoreButtonスタイルを追加
- `app/styles/blog/layer4-posts.ts` - Paginationスタイルを削除、LoadMoreButtonスタイルを追加

### 🪨route

- `app/routes/blog._index.tsx` - loaderを変更：pageパラメータをloadedパラメータに変更、calculatePaginationをcalculateLoadMoreに変更、fetcherリクエスト対応を追加

### 🚧components.test

- `app/components/blog/posts/PostsSection.test.tsx` - Paginationテストを削除、LoadMoreButtonテストを追加
- **新規** `app/components/blog/posts/LoadMoreButton.test.tsx` - LoadMoreButtonのユニットテスト（デフォルト状態、ローディング状態、全件読み込み済み状態）
- **削除** `app/components/blog/posts/Pagination.test.tsx`

### 🪨components

- `app/components/blog/posts/PostsSection.tsx` - Paginationインポートを削除、LoadMoreButtonインポートを追加、propsを変更（pagination → loadMoreInfo）
- **新規** `app/components/blog/posts/LoadMoreButton.tsx` - useFetcherで追加記事を取得、ボタンクリックで記事を追加表示、ローディング中はスピナー表示
- **削除** `app/components/blog/posts/Pagination.tsx`

### 🚧logic.test

- **新規** `app/lib/blog/posts/calculateLoadMore.test.ts` - calculateLoadMoreのユニットテスト（hasMore判定、loadedCount/totalPostsの計算）
- **削除** `app/lib/blog/posts/calculatePagination.test.ts`

### 🪨logic

- **新規** `app/lib/blog/posts/calculateLoadMore.ts` - 追加読み込み情報計算：hasMore = loadedCount < totalPosts
- **削除** `app/lib/blog/posts/calculatePagination.ts`

### 🚧data-io.test

- `app/data-io/blog/posts/fetchPosts.server.test.ts` - limit/offsetの動作確認（既存テストを維持、ページネーション関連のテストは不要）

### 🪨data-io

- `app/data-io/blog/posts/fetchPosts.server.ts` - 既存のlimit/offset処理を維持（変更不要）

### その他

- `app/specs/blog/types.ts` - PaginationData型を削除、LoadMoreInfo型を追加（loadedCount, totalPosts, hasMore, postsPerLoad）
- `develop/blog/posts/file-list.md` - 既に更新済み
- `develop/blog/posts/func-spec.md` - 既に更新済み
- `develop/blog/posts/uiux-spec.md` - 既に更新済み
- `app/specs/blog/posts-spec.yaml` - 既に更新済み
- `develop/blog/posts/data-flow-diagram.md` - 既に更新済み
