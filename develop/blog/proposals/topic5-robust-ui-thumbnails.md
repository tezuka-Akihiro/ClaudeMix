# ブログ記事企画書：Topic 5

## 1. 記事タイトル（仮）
Edge 環境で「不屈（不壊）」の UI を作る：サムネイル表示の堅牢な実装パターン

## 2. ターゲット
- **Primary**: React/Remixで画像を表示しているが、読み込みエラー時の表示崩れや、ALTテキストの一瞬のチラつきに悩んでいるフロントエンドエンジニア。
- **Secondary**: LighthouseのCLS（Layout Shift）をゼロに抑え、どんな劣悪な回線環境でも美しい表示を維持したい品質重視のエンジニア。

## 3. 作業内容の整理（Why / What / Challenge / Solution）

### Why（なぜやるのか：課題）
- 外部ストレージ（R2等）に置いた画像は、ネットワーク遅延や削除によって「必ずいつか読み込みに失敗する」。
- 画像が壊れたとき、アイコンが無残に残ったり、レイアウトが不自然に空いたりする（＝不協和音）。
- ハイドレーション（SSR後のクライアント処理）の隙間に、壊れた画像のALTテキストが一瞬だけ表示される不格好な「フラッシュ」現象。

### What（何をしたのか：実装）
- **堅牢な `PostCard` コンポーネント**: `useState` を活用した2つの状態管理（`imageError`, `isLoaded`）による精密な表示制御。
- **スペック駆動の抑制ロジック**: カテゴリごとにサムネイル表示の要否を `spec.yaml` で定義し、不要な画像リクエストを物理的に排除。
- **CSSとReactの協調**: `opacity: 0` からのフェードインと、エラー時の `display: none` によるレイアウト崩壊の防止。

### Challenge（壁：困難だった点）
- SSR（サーバーサイドレンダリング）環境において、ブラウザのキャッシュ状況によっては `onLoad` イベントが発火しない、あるいは早すぎて検知できないケースへの対応。
- 画像がない場合に「プレースホルダー」を表示するのではなく、あえて「空間ごと消去（Hide）」してコンテンツを詰めるという、ミニマリズム的な設計判断の実現。

### Solution（どう乗り越えたか：解決策）
- **「不可視状態」からのスタート**: 画像を最初から見せるのではなく、読み込み完了を確認してから `opacity` を上げることで、不完全な状態（ALTテキストのみなど）をユーザーに見せない。
- **エラー時の即時レイアウト復旧**: `onError` をトリガーにコンテナごと非表示にし、Lighthouseスコアへの影響を最小限に抑える実装。

## 4. 記事の提供価値と品質評価

### 提供価値のカテゴリ
- **ClaudeMix 記録**: 実装上の細かな落とし穴（フラッシュ現象など）を解決したフロントエンドの実践ログ。

### 品質基準の評価
- **希少性（中）**: 単なる画像表示ではなく、「エラー時の挙動」と「Lighthouse最適化」を極限まで突き詰めた解説は実戦的で価値が高い。
- **具体性（高）**: `PostCard.tsx` の実際のコードスニペットと、CSSでのスタイリング、`onLoad/onError` のハンドリング手法を詳述。
- **新規性（中）**: SSR/Remix環境におけるハイドレーションを考慮した最新のReactパターン。
- **実証性（高）**: このブログの全記事一覧・詳細画面で適用されており、劣悪な回線シミュレーション下でも表示が崩れないことを確認済み。

## 5. 導入部分の構成（恐怖型BAB法）

### Before（現状の痛み：恐怖の提示）
あなたのサイトを、低速なモバイル回線や、画像ストレージが一時的に不安定な状態で開いてみてください。
画像が読み込まれるまでの間、ALTテキストが無防備に表示され、読み込みに失敗した瞬間、無残な「リンク切れアイコン」がレイアウトを突き破る。
そんな「壊れかけのUI」は、ユーザーに「このサービスは放置されている」という不信感を与え、あなたのブランド価値を音を立てて崩していきます。

### After（解決後の未来：希望の提示）
たとえ画像が1枚も読み込めなくても、レイアウトは寸分の狂いもなく、美しいテキストと余白が整然と並びます。
画像が表示されるときは、安っぽいチラつきを見せることなく、滑らかなフェードインと共に現れる。
どんな環境でも「壊れない」という信頼感。それが、プロが作るプロダクトと、趣味で作るサイトを分かつ決定的な境界線です。

### Bridge（解決策の提示：この記事でわかること）
「正しく表示されること」を祈るのではなく、「正しく表示されない時」を設計する。
この記事では、エッジ環境で動くRemixブログにおいて、不屈（不壊）のUIを実現するための画像ハンドリングパターンと、`spec.yaml` による賢い制御手法を公開します。

## 6. カテゴリ・タグ
- **カテゴリ**: ClaudeMix 記録
- **タグ**: React, Remix, CSS, Frontend, Performance

## 7. オペレーターへの確認事項
- プレースホルダー（ダミー画像）を表示するパターンと、今回の「隠す（Hide）」パターンの設計思想の違いについて深掘りしますか？
