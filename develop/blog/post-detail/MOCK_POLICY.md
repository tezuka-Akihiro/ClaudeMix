# MOCK_POLICY.md - post-detail Section

## 📋 モック実装方針

### ⚠️ モック実装は不要

このセクションでは、段階的強化（Progressive Enhancement）におけるモック実装フェーズを**スキップ**します。

---

## 🤔 モック実装が不要な理由

### 1. シンプルな閲覧専用機能

post-detailセクションは以下の特徴を持つシンプルな機能です：

- **閲覧専用**: ユーザーによるデータ変更アクション（フォーム送信、編集など）が存在しない
- **直線的なデータフロー**: URL → データ取得 → 変換 → 表示という単純なフロー
- **UI複雑性が低い**: 記事のメタデータと本文を表示するだけのシンプルなUI

### 2. データ取得処理の実装が容易

- **Data-IO層**: ファイルシステムやデータベースから記事データを取得するシンプルな処理
- **Pure Logic層**: マークダウンをHTMLに変換する純粋関数（既存ライブラリの活用が可能）
- **早期に実データで検証可能**: モックデータではなく実際のマークダウンファイルを使用した方が、画像・Mermaid図の処理を含めて正確に検証できる

### 3. UI開発とロジック開発の並行作業が不要

- **依存関係が単純**: UIはloaderから受け取ったデータを表示するだけ
- **フィードバックループが不要**: 複雑なユーザーインタラクションや状態管理がないため、UI開発とロジック開発を分離する必要性が低い

---

## ✅ 推奨される開発アプローチ

### Outside-In TDD（モックなし）

1. **Phase 1: E2Eテスト作成**
   - `tests/e2e/section/blog/post-detail.spec.ts` を作成
   - 失敗するE2Eテストを書く（記事詳細ページの表示、マークダウン変換、404エラー処理）

2. **Phase 2.1: Data-IO層実装**
   - `app/data-io/blog/post-detail/fetchPostBySlug.server.ts` を実装
   - テストデータ（サンプルマークダウンファイル）を準備
   - Data-IO層の単体テストを実装

3. **Phase 2.2: Pure Logic層実装**
   - `app/lib/blog/post-detail/markdownConverter.ts` を実装
   - マークダウン変換ライブラリを選定・導入
   - Pure Logic層の単体テストを実装（画像・Mermaid処理を含む）

4. **Phase 2.3: UI層実装**
   - `app/routes/blog.$slug.tsx` を実装（loader、ErrorBoundary）
   - `app/components/blog/post-detail/PostDetailSection.tsx` を実装
   - UI層の単体テストを実装

5. **Phase 3: E2Eテスト実行・検証**
   - 全E2Eテストを実行し、すべてパスすることを確認

---

## 📝 補足: モック実装が有効なケース

以下のようなケースでは、モック実装が有効です（post-detailセクションには該当しません）：

- **複雑なフォーム**: 多数の入力フィールド、バリデーション、条件分岐があるフォーム
- **複雑な状態管理**: ユーザーインタラクションによって複雑に状態が変化するUI
- **外部APIの依存**: 外部APIの開発が未完了で、UI開発を先行させる必要がある場合
- **パフォーマンス最適化**: 大量データの処理が必要で、UI開発時に実データを使うと開発効率が低下する場合

---

## 🎯 結論

post-detailセクションは、モック実装フェーズをスキップし、**最初から実データを使用したOutside-In TDD**で開発を進めることを推奨します。

この方針により、以下のメリットが得られます：

- ✅ 開発工数の削減（モック実装とモック削除の工程が不要）
- ✅ 実データでの早期検証（マークダウン変換の品質を初期段階から確認可能）
- ✅ シンプルな開発フロー（TDD_WORK_FLOW.md で管理する工程が減る）
